exports.id=995,exports.ids=[995],exports.modules={4636:(a,b,c)=>{"use strict";c.d(b,{az:()=>e,gw:()=>d});let d=["映画","アニメ","ゲーム","漫画"],e=["planned","in_progress","on_hold"]},23561:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>s,metadata:()=>q});var d=c(75338),e=c(65169),f=c.n(e),g=c(39469),h=c.n(g);c(82704);var i=c(34274),j=c(74515),k=c(94936),l=c(86281),m=c(95012);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg border border-transparent text-sm font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-[0_10px_20px_-14px_hsl(var(--primary))] hover:brightness-110",secondary:"border-border/70 bg-muted/70 text-foreground hover:bg-muted",outline:"border-border/80 bg-transparent hover:bg-accent hover:text-accent-foreground",ghost:"text-foreground/85 hover:bg-accent hover:text-accent-foreground",destructive:"bg-red-600 text-white hover:bg-red-500"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-lg px-3",lg:"h-11 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=j.forwardRef(({className:a,variant:b,size:c,asChild:e=!1,...f},g)=>{let h=e?k.DX:"button";return(0,d.jsx)(h,{className:(0,m.cn)(n({variant:b,size:c,className:a})),ref:g,...f})});o.displayName="Button";var p=c(64445);let q={title:"Flowlog",description:"これから見る・やる作品の個人管理アプリ"};async function r(){let a=await (0,p.U)(),{data:b}=await a.auth.getUser(),c=b.user;return(0,d.jsx)("header",{className:"sticky top-0 z-40 border-b border-border/80 bg-card/92 backdrop-blur-md",children:(0,d.jsxs)("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-3",children:[(0,d.jsx)(f(),{href:"/",className:"text-lg font-extrabold tracking-tight text-foreground/95",children:"Flowlog"}),c?(0,d.jsxs)("nav",{className:"flex items-center gap-2 rounded-full border border-border/70 bg-background/55 px-2 py-1",children:[(0,d.jsx)(o,{asChild:!0,variant:"ghost",size:"sm",children:(0,d.jsx)(f(),{href:"/",children:"ホーム"})}),(0,d.jsx)(o,{asChild:!0,variant:"ghost",size:"sm",children:(0,d.jsx)(f(),{href:"/add",children:"追加"})}),(0,d.jsx)(o,{asChild:!0,variant:"ghost",size:"sm",children:(0,d.jsx)(f(),{href:"/library",children:"ライブラリ"})}),(0,d.jsx)(o,{asChild:!0,variant:"ghost",size:"sm",children:(0,d.jsx)(f(),{href:"/manage",children:"管理"})}),(0,d.jsx)("form",{action:i.ri,children:(0,d.jsx)(o,{size:"sm",variant:"secondary",type:"submit",children:"ログアウト"})})]}):null]})})}function s({children:a}){return(0,d.jsx)("html",{lang:"ja",className:"dark",children:(0,d.jsxs)("body",{className:h().className,children:[(0,d.jsx)(r,{}),(0,d.jsx)("main",{className:"mx-auto max-w-6xl px-4 py-6",children:a})]})})}},30515:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,65169,23))},34274:(a,b,c)=>{"use strict";c.d(b,{Rp:()=>p,Yb:()=>t,ZO:()=>m,ck:()=>r,ri:()=>u,rv:()=>n,wd:()=>o,yB:()=>s});var d=c(75879);c(68633);var e=c(16780),f=c(82161),g=c(38629),h=c(4636),i=c(64445),j=c(51669);let k=g.Ikc({title:g.YjP().min(1),type_id:g.YjP().uuid(),series_id:g.YjP().uuid().nullable().optional(),status:g.k5n(["planned","in_progress","on_hold","completed"]),rating:g.aig().min(0).max(5).nullable().optional(),review_text:g.YjP().nullable().optional(),why_interested:g.YjP().nullable().optional(),availability_end:g.YjP().nullable().optional(),thumbnail_url:g.YjP().url().nullable().optional(),tags:g.YOg(g.YjP()).default([])});async function l(){let a=await (0,i.U)(),{data:{user:b}}=await a.auth.getUser();if(!b)throw Error("Unauthorized");return{supabase:a,user:b}}async function m(){let{supabase:a,user:b}=await l(),{data:c}=await a.from("content_types").select("name").eq("user_id",b.id),d=new Set((c??[]).map(a=>a.name)),e=h.gw.filter(a=>!d.has(a)).map(a=>({user_id:b.id,name:a}));e.length>0&&await a.from("content_types").insert(e)}async function n(a){let{supabase:b,user:c}=await l(),d=a.trim();if(!d)throw Error("Type name required");await b.from("content_types").insert({user_id:c.id,name:d}),(0,e.revalidatePath)("/"),(0,e.revalidatePath)("/add"),(0,e.revalidatePath)("/library")}async function o(a){let{supabase:b,user:c}=await l(),d=a.trim();if(!d)throw Error("Series name required");await b.from("series").insert({user_id:c.id,name:d}),(0,e.revalidatePath)("/"),(0,e.revalidatePath)("/add"),(0,e.revalidatePath)("/library")}async function p(a){let b=k.parse(a),{supabase:c,user:d}=await l(),{data:f,error:g}=await c.from("works").insert({title:b.title,thumbnail_url:b.thumbnail_url??null}).select("id").single();if(g)throw g;let h="completed"===b.status?new Date().toISOString():null,{data:i,error:j}=await c.from("work_items").insert({user_id:d.id,work_id:f.id,type_id:b.type_id,series_id:b.series_id??null,status:b.status,rating:b.rating??null,review_text:b.review_text??null,why_interested:b.why_interested??null,availability_end:b.availability_end??null,completed_at:h,tags:b.tags}).select("id,type_id").single();if(j)throw j;let[{data:m},{data:n}]=await Promise.all([c.from("list_orders").select("position").eq("user_id",d.id).eq("scope_type","global").order("position",{ascending:!1}).limit(1).maybeSingle(),c.from("list_orders").select("position").eq("user_id",d.id).eq("scope_type","type").eq("type_id",i.type_id).order("position",{ascending:!1}).limit(1).maybeSingle()]);await c.from("list_orders").insert([{user_id:d.id,scope_type:"global",work_item_id:i.id,position:(m?.position??0)+1},{user_id:d.id,scope_type:"type",type_id:i.type_id,work_item_id:i.id,position:(n?.position??0)+1}]),(0,e.revalidatePath)("/"),(0,e.revalidatePath)("/library"),(0,e.revalidatePath)("/manage")}let q=k.extend({id:g.YjP().uuid()});async function r(a){let b=q.parse(a),{supabase:c,user:d}=await l(),f="completed"===b.status?new Date().toISOString():null,{data:g,error:h}=await c.from("work_items").select("work_id").eq("id",b.id).eq("user_id",d.id).single();if(h)throw h;let{error:i}=await c.from("works").update({title:b.title,thumbnail_url:b.thumbnail_url??null}).eq("id",g.work_id);if(i)throw i;let{error:j}=await c.from("work_items").update({type_id:b.type_id,series_id:b.series_id??null,status:b.status,rating:b.rating??null,review_text:b.review_text??null,why_interested:b.why_interested??null,availability_end:b.availability_end??null,completed_at:f,tags:b.tags}).eq("id",b.id).eq("user_id",d.id);if(j)throw j;(0,e.revalidatePath)("/"),(0,e.revalidatePath)("/library"),(0,e.revalidatePath)("/manage")}async function s(a,b){let{supabase:c,user:d}=await l(),f="completed"===b?new Date().toISOString():null,{error:g}=await c.from("work_items").update({status:b,completed_at:f}).eq("id",a).eq("user_id",d.id);if(g)throw g;(0,e.revalidatePath)("/"),(0,e.revalidatePath)("/library"),(0,e.revalidatePath)("/manage")}async function t(a,b,c){let{supabase:d,user:f}=await l(),g=d.from("list_orders").delete().eq("user_id",f.id).eq("scope_type",a);"type"===a&&(g=g.eq("type_id",b)),"global"===a&&(g=g.is("type_id",null));let{error:h}=await g;if(h)throw h;let i=c.map((c,d)=>({user_id:f.id,scope_type:a,type_id:"type"===a?b:null,work_item_id:c,position:d+1}));if(i.length>0){let{error:a}=await d.from("list_orders").insert(i);if(a)throw a}(0,e.revalidatePath)("/")}async function u(){let a=await (0,i.U)();await a.auth.signOut(),(0,f.redirect)("/login")}(0,j.D)([m,n,o,p,r,s,t,u]),(0,d.A)(m,"00db8d2cf9fb922cb6a553acde41dbc8a1423d8227",null),(0,d.A)(n,"40b10458f459258132b12ff6dbefb1bf035c4fcc6b",null),(0,d.A)(o,"4025e5480231b04ea434de5c8f0aca107fee1c2e3b",null),(0,d.A)(p,"40dfdaf845b1f8d696d63eeb0cc30e37c6a43a649b",null),(0,d.A)(r,"4014c53abf1dd202fe829c7cd41e8361f122e2a43b",null),(0,d.A)(s,"604d7ee4dd2b90160f39eb8505a9bd409eafd21667",null),(0,d.A)(t,"70b2c2eb0a87f08d6d6f8b0f6e14742dcccc99fd2d",null),(0,d.A)(u,"00c38f18042460ac51226f9f4844cf59b0cb5c6d97",null)},45341:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},64445:(a,b,c)=>{"use strict";c.d(b,{U:()=>f});var d=c(27968),e=c(86802);async function f(){let a=await (0,e.UL)(),b="https://qnfjcreqqorkokspmyul.supabase.co",c="sb_publishable_qDSxqENJooQJqhPYUYaLww_-xBkdn2T";if(!b||!c)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");return(0,d.createServerClient)(b,c,{cookies:{getAll:()=>a.getAll(),setAll(b){try{b.forEach(({name:b,value:c,options:d})=>a.set(b,c,d))}catch{}}}})}},67467:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,3991,23))},72957:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},82704:()=>{},82839:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"00c38f18042460ac51226f9f4844cf59b0cb5c6d97":()=>d.ri,"00db8d2cf9fb922cb6a553acde41dbc8a1423d8227":()=>d.ZO,"4014c53abf1dd202fe829c7cd41e8361f122e2a43b":()=>d.ck,"4025e5480231b04ea434de5c8f0aca107fee1c2e3b":()=>d.wd,"40b10458f459258132b12ff6dbefb1bf035c4fcc6b":()=>d.rv,"40dfdaf845b1f8d696d63eeb0cc30e37c6a43a649b":()=>d.Rp,"604d7ee4dd2b90160f39eb8505a9bd409eafd21667":()=>d.yB,"70b2c2eb0a87f08d6d6f8b0f6e14742dcccc99fd2d":()=>d.Yb});var d=c(34274)},95012:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f});var d=c(81171),e=c(11167);function f(...a){return(0,e.QP)((0,d.$)(a))}}};